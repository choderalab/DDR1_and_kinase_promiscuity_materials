# Affinity-based clustering

Data and code used to generate Figures 1, S1, and S2 of the paper 'What makes a kinase promiscuous for inhibitors?'.  

#### Data
* `S4Table.xlsx` - the original binding affinity data of 406 kinases by 645 ligands from [Drewry et al, 2017](https://doi.org/10.1371/journal.pone.0181585). From this two csv files were created that were used in the actual analysis:
  * `Drewry-data.csv`
  * `Drewry-data-with-chemotype.csv`
* Also included is the data from [Davis et al, 2011](https://doi.org/10.1038/nbt.1990) in the form of `Davis_2011_transpose.csv`
#### R Scripts
* `Drewry_dendrogram_dots_colored.R` makes `Drewry-dendrogram-rainbow-dot-labels.eps` (Fig. 1A) a spread depiction of the resulting dendrogram colored by 90% inhibition (imported from a csv file made by `.ipynb` below)
  * The resulting tree `hclust_tree.tre` is also generated by this script
  * The file `Drewry-dendrogram-rainbow-real-labels.eps`, which is used to make `Drewry-dendrogram-searchable.pdf`, a searchable PDF of this tree, is also generated by this script.
* Figure 1B was created by importing `hclust_tree.tre` into `FigTree v1.3.1`
* `Drewry_dendrogram_colored.R` makes `Drewry-dendrogram-colors.pdf` (Fig. S1B), a horizontal depiction of the resulting dendrogram colored by 75% inhibition (imported from a csv file made by `.ipynb` below)
* `Drewry_dendrogram_colored-UPGMA.R` makes `Drewry-dendrogram-UPGMA-colors.pdf` (Fig. S1C), a horizontal depiction dendrogram resulting from clustering the same data with the 'average' instead of the 'complete' method colored by 75% inhibition (imported from a csv file made by `.ipynb` below)
* `hclust-consensus-1000.R` makes `Drewry-consensus-three-colors.pdf` (Fig. S2A), a consensus tree of 1000 bootstrapped trees using the complete linkage method
    * This script also produces all 1000 trees as `hclust-consensus-1000.tre` and the consensus tree as calculated using the [consense](http://evolution.genetics.washington.edu/phylip/doc/consense.html) method as `outtree`
#### iPython notebooks
* `promiscuity_plots.ipynb` - ipython notebook used to produce Figure 1C  and the input for Figure 1D as well as Figures S2B and S2C
  * Produces `promiscuity_plot_rainbow_Inh90.eps` (Fig. 1C), `promiscuity_plot_rainbow_Inh90-Abl.png` (Fig. S2C), and `promiscuity_plot_Davis.png` (Fig. S2B)
  * The `.csv` files produced here are used in the R scripts above and as input for the kinmap tool at kinhub.org to generate Figure 1D.
* `Drewry_dendrogram.ipynb` - ipython notebook used to produce Figure S1A
  * Produces `SNS-heatmap.pdf` (Fig. S1A)
